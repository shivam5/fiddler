{
  "timestamp": "2025-04-17T03:58:58.333064",
  "config": {
    "model": "mistralai/Mixtral-8x7B-v0.1",
    "cpu_offload": 1,
    "batch_size": 2,
    "beam_num": 1,
    "routing_policy": "do-nothing",
    "input_token": 512,
    "output_token": 128
  },
  "results": [
    {
      "batch_num": 0,
      "prefill_time": 6.202817440032959,
      "decode_time": 48.65691304206848,
      "total_time": 54.85973048210144,
      "hit_rate": 0.8680555555555556,
      "throughput": 2.630664215983697,
      "total_experts_processed": 256,
      "gpu_experts_processed": 217,
      "cpu_experts_processed": 39,
      "gpu_expert_percentage": 0.84765625,
      "expert_utilization": {
        "total": {
          "all": 102,
          "gpu": 90,
          "cpu": 12
        },
        "by_layer": {
          "0": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              1,
              4
            ],
            "gpu_experts": [
              1,
              4
            ],
            "cpu_experts": []
          },
          "1": {
            "unique_experts_used": 4,
            "experts_on_gpu": 2,
            "experts_on_cpu": 2,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              3,
              6,
              7
            ],
            "gpu_experts": [
              6,
              7
            ],
            "cpu_experts": [
              1,
              3
            ]
          },
          "2": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              2,
              4,
              5,
              7
            ],
            "gpu_experts": [
              2,
              4,
              5
            ],
            "cpu_experts": [
              7
            ]
          },
          "3": {
            "unique_experts_used": 4,
            "experts_on_gpu": 2,
            "experts_on_cpu": 2,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              2,
              3,
              4,
              5
            ],
            "gpu_experts": [
              4,
              5
            ],
            "cpu_experts": [
              2,
              3
            ]
          },
          "4": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              2,
              7
            ],
            "gpu_experts": [
              2,
              7
            ],
            "cpu_experts": []
          },
          "5": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              0,
              1,
              4
            ],
            "gpu_experts": [
              0,
              1,
              4
            ],
            "cpu_experts": []
          },
          "6": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              5,
              7
            ],
            "gpu_experts": [
              1,
              5,
              7
            ],
            "cpu_experts": []
          },
          "7": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              0,
              1,
              4
            ],
            "gpu_experts": [
              1,
              4
            ],
            "cpu_experts": [
              0
            ]
          },
          "8": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              0,
              2,
              5
            ],
            "gpu_experts": [
              0,
              5
            ],
            "cpu_experts": [
              2
            ]
          },
          "9": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              0,
              5
            ],
            "gpu_experts": [
              0,
              5
            ],
            "cpu_experts": []
          },
          "10": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              4,
              7
            ],
            "gpu_experts": [
              1,
              4
            ],
            "cpu_experts": [
              7
            ]
          },
          "11": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              1,
              2,
              6
            ],
            "gpu_experts": [
              0,
              1,
              2,
              6
            ],
            "cpu_experts": []
          },
          "12": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              5,
              7
            ],
            "gpu_experts": [
              1,
              5
            ],
            "cpu_experts": [
              7
            ]
          },
          "13": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              0,
              1
            ],
            "gpu_experts": [
              0,
              1
            ],
            "cpu_experts": []
          },
          "14": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              2,
              5
            ],
            "gpu_experts": [
              1,
              2,
              5
            ],
            "cpu_experts": []
          },
          "15": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              5,
              6
            ],
            "gpu_experts": [
              1,
              5,
              6
            ],
            "cpu_experts": []
          },
          "16": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              4,
              6,
              7
            ],
            "gpu_experts": [
              4,
              6,
              7
            ],
            "cpu_experts": []
          },
          "17": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              2,
              5
            ],
            "gpu_experts": [
              2,
              5
            ],
            "cpu_experts": [
              1
            ]
          },
          "18": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              3,
              4,
              6
            ],
            "gpu_experts": [
              1,
              3,
              4,
              6
            ],
            "cpu_experts": []
          },
          "19": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              2,
              6
            ],
            "gpu_experts": [
              2,
              6
            ],
            "cpu_experts": []
          },
          "20": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              1,
              3,
              5
            ],
            "gpu_experts": [
              0,
              1,
              3,
              5
            ],
            "cpu_experts": []
          },
          "21": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              2,
              5,
              6
            ],
            "gpu_experts": [
              1,
              2,
              5,
              6
            ],
            "cpu_experts": []
          },
          "22": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              1,
              3,
              5
            ],
            "gpu_experts": [
              0,
              1,
              3,
              5
            ],
            "cpu_experts": []
          },
          "23": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              2,
              4,
              5,
              6
            ],
            "gpu_experts": [
              2,
              4,
              5,
              6
            ],
            "cpu_experts": []
          },
          "24": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              2,
              6,
              7
            ],
            "gpu_experts": [
              0,
              2,
              6,
              7
            ],
            "cpu_experts": []
          },
          "25": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              2,
              5,
              7
            ],
            "gpu_experts": [
              0,
              2,
              5,
              7
            ],
            "cpu_experts": []
          },
          "26": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              0,
              5
            ],
            "gpu_experts": [
              0,
              5
            ],
            "cpu_experts": []
          },
          "27": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              4,
              5,
              6
            ],
            "gpu_experts": [
              4,
              5,
              6
            ],
            "cpu_experts": []
          },
          "28": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              0,
              2,
              7
            ],
            "gpu_experts": [
              0,
              2
            ],
            "cpu_experts": [
              7
            ]
          },
          "29": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              3,
              4,
              7
            ],
            "gpu_experts": [
              1,
              3,
              4,
              7
            ],
            "cpu_experts": []
          },
          "30": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              3,
              7
            ],
            "gpu_experts": [
              3,
              7
            ],
            "cpu_experts": []
          },
          "31": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              2,
              3,
              5,
              7
            ],
            "gpu_experts": [
              2,
              5,
              7
            ],
            "cpu_experts": [
              3
            ]
          }
        },
        "decode_step": true,
        "tokens_per_batch": 2,
        "unique_experts_per_batch": {},
        "avg_experts_per_layer": 3.1875,
        "avg_gpu_experts_per_layer": 2.8125,
        "avg_cpu_experts_per_layer": 0.375,
        "avg_experts_per_token": 2.0,
        "avg_unique_experts_per_batch": 3.1875
      }
    },
    {
      "batch_num": 1,
      "prefill_time": 5.190056562423706,
      "decode_time": 46.28916120529175,
      "total_time": 51.479217767715454,
      "hit_rate": 0.8662827660406885,
      "throughput": 2.765226171032175,
      "total_experts_processed": 256,
      "gpu_experts_processed": 217,
      "cpu_experts_processed": 39,
      "gpu_expert_percentage": 0.84765625,
      "expert_utilization": {
        "total": {
          "all": 109,
          "gpu": 90,
          "cpu": 19
        },
        "by_layer": {
          "0": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              2,
              4,
              5,
              7
            ],
            "gpu_experts": [
              2,
              4,
              5,
              7
            ],
            "cpu_experts": []
          },
          "1": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              2,
              4
            ],
            "gpu_experts": [
              2,
              4
            ],
            "cpu_experts": [
              1
            ]
          },
          "2": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              3,
              4,
              6
            ],
            "gpu_experts": [
              0,
              4,
              6
            ],
            "cpu_experts": [
              3
            ]
          },
          "3": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              1,
              3,
              4
            ],
            "gpu_experts": [
              0,
              1,
              4
            ],
            "cpu_experts": [
              3
            ]
          },
          "4": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              2,
              4,
              7
            ],
            "gpu_experts": [
              1,
              2,
              4,
              7
            ],
            "cpu_experts": []
          },
          "5": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              2,
              4,
              6
            ],
            "gpu_experts": [
              1,
              4,
              6
            ],
            "cpu_experts": [
              2
            ]
          },
          "6": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              5,
              6
            ],
            "gpu_experts": [
              1,
              5,
              6
            ],
            "cpu_experts": []
          },
          "7": {
            "unique_experts_used": 4,
            "experts_on_gpu": 2,
            "experts_on_cpu": 2,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              5,
              6,
              7
            ],
            "gpu_experts": [
              5,
              6
            ],
            "cpu_experts": [
              0,
              7
            ]
          },
          "8": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              1,
              6,
              7
            ],
            "gpu_experts": [
              0,
              1,
              6,
              7
            ],
            "cpu_experts": []
          },
          "9": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              2,
              5,
              6
            ],
            "gpu_experts": [
              0,
              2,
              5,
              6
            ],
            "cpu_experts": []
          },
          "10": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              2,
              5,
              6
            ],
            "gpu_experts": [
              2,
              5
            ],
            "cpu_experts": [
              6
            ]
          },
          "11": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              2,
              3,
              6
            ],
            "gpu_experts": [
              2,
              6
            ],
            "cpu_experts": [
              3
            ]
          },
          "12": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              2,
              5,
              7
            ],
            "gpu_experts": [
              2,
              5
            ],
            "cpu_experts": [
              7
            ]
          },
          "13": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              0,
              1
            ],
            "gpu_experts": [
              0,
              1
            ],
            "cpu_experts": []
          },
          "14": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              2,
              5,
              6
            ],
            "gpu_experts": [
              2,
              5,
              6
            ],
            "cpu_experts": []
          },
          "15": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              2,
              5
            ],
            "gpu_experts": [
              1,
              2,
              5
            ],
            "cpu_experts": []
          },
          "16": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              0,
              1,
              2
            ],
            "gpu_experts": [
              0,
              1,
              2
            ],
            "cpu_experts": []
          },
          "17": {
            "unique_experts_used": 3,
            "experts_on_gpu": 1,
            "experts_on_cpu": 2,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              3,
              7
            ],
            "gpu_experts": [
              7
            ],
            "cpu_experts": [
              1,
              3
            ]
          },
          "18": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              3,
              4
            ],
            "gpu_experts": [
              1,
              3,
              4
            ],
            "cpu_experts": []
          },
          "19": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              2,
              5,
              6,
              7
            ],
            "gpu_experts": [
              2,
              5,
              6
            ],
            "cpu_experts": [
              7
            ]
          },
          "20": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              0,
              4,
              5
            ],
            "gpu_experts": [
              0,
              4,
              5
            ],
            "cpu_experts": []
          },
          "21": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              4,
              5
            ],
            "gpu_experts": [
              1,
              4,
              5
            ],
            "cpu_experts": []
          },
          "22": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              1,
              4,
              7
            ],
            "gpu_experts": [
              1,
              4
            ],
            "cpu_experts": [
              7
            ]
          },
          "23": {
            "unique_experts_used": 3,
            "experts_on_gpu": 3,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              2,
              5,
              6
            ],
            "gpu_experts": [
              2,
              5,
              6
            ],
            "cpu_experts": []
          },
          "24": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              3,
              4,
              6
            ],
            "gpu_experts": [
              1,
              3,
              6
            ],
            "cpu_experts": [
              4
            ]
          },
          "25": {
            "unique_experts_used": 2,
            "experts_on_gpu": 2,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 2,
            "experts_used": [
              3,
              7
            ],
            "gpu_experts": [
              3,
              7
            ],
            "cpu_experts": []
          },
          "26": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              3,
              4,
              7
            ],
            "gpu_experts": [
              0,
              3,
              7
            ],
            "cpu_experts": [
              4
            ]
          },
          "27": {
            "unique_experts_used": 3,
            "experts_on_gpu": 2,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 3,
            "experts_used": [
              3,
              4,
              5
            ],
            "gpu_experts": [
              4,
              5
            ],
            "cpu_experts": [
              3
            ]
          },
          "28": {
            "unique_experts_used": 4,
            "experts_on_gpu": 2,
            "experts_on_cpu": 2,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              0,
              4,
              5,
              7
            ],
            "gpu_experts": [
              0,
              4
            ],
            "cpu_experts": [
              5,
              7
            ]
          },
          "29": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              4,
              5,
              7
            ],
            "gpu_experts": [
              1,
              4,
              5,
              7
            ],
            "cpu_experts": []
          },
          "30": {
            "unique_experts_used": 4,
            "experts_on_gpu": 3,
            "experts_on_cpu": 1,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              3,
              5,
              6,
              7
            ],
            "gpu_experts": [
              3,
              6,
              7
            ],
            "cpu_experts": [
              5
            ]
          },
          "31": {
            "unique_experts_used": 4,
            "experts_on_gpu": 4,
            "experts_on_cpu": 0,
            "tokens_processed": 2,
            "experts_per_token": 2.0,
            "unique_experts_per_batch": 4,
            "experts_used": [
              1,
              2,
              5,
              7
            ],
            "gpu_experts": [
              1,
              2,
              5,
              7
            ],
            "cpu_experts": []
          }
        },
        "decode_step": true,
        "tokens_per_batch": 2,
        "unique_experts_per_batch": {},
        "avg_experts_per_layer": 3.40625,
        "avg_gpu_experts_per_layer": 2.8125,
        "avg_cpu_experts_per_layer": 0.59375,
        "avg_experts_per_token": 2.0,
        "avg_unique_experts_per_batch": 3.40625
      }
    }
  ],
  "summary": {
    "avg_prefill_time": 5.6964370012283325,
    "avg_decode_time": 47.473037123680115,
    "avg_total_time": 53.16947412490845,
    "avg_hit_rate": 0.867169160798122,
    "avg_throughput": 2.6979451935079357,
    "avg_gpu_expert_percentage": 0.84765625,
    "tokens_per_second": 5.392534699919255,
    "avg_unique_experts_per_batch": 3.296875
  }
}